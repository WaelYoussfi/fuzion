// original lua code:
//
// function a(k,x1,x2,x3,x4,x5)
//   local function b()
//      k = k - 1
//      return a(k,b,x1,x2,x3,x4)
//    end
//     if k <= 0 then return x4() + x5() else return b() end
//  end
//
//  function K(n)
//    return function()
//      return n
//    end
//  end
//
//  print(a(10, K(1), K(-1), K(-1), K(1), K(0)))

man_or_boy
{
  a(k i32, x1, x2, x3, x4, x5 fun i32) i32
  {
    b =>
    {
      k = k - 1;
      a(k,fun b,x1,x2,x3,x4)
    }
    if k <= 0 { x4() + x5() } else { b }
    // k <= 0 ? x4() + x5() : b
  }

  // a(k i32, x1, x2, x3, x4, x5 fun () i32) => { b => { k = k - 1;
  //                                                     a(k,fun b ,x1,x2,x3,x4)
  //                                                   };
  //                                              k <= 0 ? x4() + x5() : b
  //                                            }

  // a(k i32, x1, x2, x3, x4, x5 fun () i32) => k <= 0 ? x4() + x5() : b;
  // a.b => { k = k - 1;
  //          a(k,fun b ,x1,x2,x3,x4)
  //        };

  // K(n i32) => fun () i32 { n };
  // K(n i32) => fun i32 { n };
  // K(n i32) => fun () => n;
  // K(n i32) => fun => n;
  K(n i32) => fun n;

  (0..10) | fun (n i32)
    {
      stdout.println("manorboy a(" + n + ") = " + a(n, K( 1), K(-1), K(-1), K( 1), K( 0)));
    }
}
